{
  "resourceType": "PlanDefinition",
  "id": "cpg-common-registration",
  "text": {
    "status": "generated",
    "div": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><p><b>Generated Narrative with Details</b></p><p><b>id</b>: cpg-common-registration</p><p><b>url</b>: <a href=\"http://hl7.org/fhir/uv/cpg/PlanDefinition/cpg-common-registration\">http://hl7.org/fhir/uv/cpg/PlanDefinition/cpg-common-registration</a></p><p><b>version</b>: 0.1.0</p><p><b>name</b>: PlanDefinition_CPG_Common_Registration</p><p><b>title</b>: PlanDefinition - CPG Common Registration</p><p><b>type</b>: Workflow Definition <span style=\"background: LightGoldenRodYellow\">(Details : {http://terminology.hl7.org/CodeSystem/plan-definition-type code 'workflow-definition' = 'Workflow Definition', given as 'Workflow Definition'})</span></p><p><b>status</b>: draft</p><p><b>date</b>: May 15, 2019 12:00:00 AM</p><p><b>jurisdiction</b>: World <span style=\"background: LightGoldenRodYellow\">(Details : {http://unstats.un.org/unsd/methods/m49/m49.htm code '001' = 'World', given as 'World'})</span></p><p><b>copyright</b>: © WHO 2019+.</p><blockquote><p><b>action</b></p><p><b>title</b>: Registration</p><p><b>code</b>: Registration <span style=\"background: LightGoldenRodYellow\">(Details : {http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process code 'registration' = 'Registration)</span></p><blockquote><p><b>participant</b></p><p><b>type</b>: patient</p><p><b>role</b>: Patient <span style=\"background: LightGoldenRodYellow\">(Details : {http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-persona code 'C000' = 'Patient)</span></p></blockquote><blockquote><p><b>participant</b></p><p><b>type</b>: practitioner</p><p><b>role</b>: Clerical support worker <span style=\"background: LightGoldenRodYellow\">(Details : {http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-persona code 'W000' = 'Clerical support worker', given as 'Clerical support worker'})</span></p></blockquote><h3>Actions</h3><table class=\"grid\"><tr><td>-</td></tr><tr><td>*</td></tr><tr><td>*</td></tr><tr><td>*</td></tr><tr><td>*</td></tr><tr><td>*</td></tr><tr><td>*</td></tr></table></blockquote></div>"
  },
  "url": "http://hl7.org/fhir/uv/cpg/PlanDefinition/cpg-common-registration",
  "version": "0.1.0",
  "name": "PlanDefinition_CPG_Common_Registration",
  "title": "PlanDefinition - CPG Common Registration",
  "type": {
    "coding": [
      {
        "system": "http://terminology.hl7.org/CodeSystem/plan-definition-type",
        "code": "workflow-definition",
        "display": "Workflow Definition"
      }
    ]
  },
  "status": "draft",
  "date": "2019-05-15T00:00:00-04:00",
  "jurisdiction": [
    {
      "coding": [
        {
          "system": "http://unstats.un.org/unsd/methods/m49/m49.htm",
          "code": "001",
          "display": "World"
        }
      ]
    }
  ],
  "copyright": "© WHO 2019+.",
  "action": [
    {
      "title": "Registration",
      "code": [
        {
          "coding": [
            {
              "system": "http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process",
              "code": "registration"
            }
          ]
        }
      ],
      "participant": [
        {
          "type": "patient",
          "role": {
            "coding": [
              {
                "system": "http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-persona",
                "code": "C000"
              }
            ]
          }
        },
        {
          "type": "practitioner",
          "role": {
            "coding": [
              {
                "system": "http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-persona",
                "code": "W000",
                "display": "Clerical support worker"
              }
            ]
          }
        }
      ],
      "action": [
        {
          "title": "Gather identifying information",
          "output": [
            {
              "type": "QuestionnaireResponse"
            }
          ],
          "participant": [
            {
              "type": "patient",
              "role": {
                "coding": [
                  {
                    "system": "http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-persona",
                    "code": "C000"
                  }
                ]
              }
            }
          ]
        },
        {
          "title": "Patient match",
          "input": [
            {
              "type": "QuestionnaireResponse",
              "codeFilter": [
                {
                  "path": "questionnaire",
                  "code": [
                    {
                      "code": "http://hl7.org/fhir/uv/cpg/Questionnaire/cpg-common-identity"
                    }
                  ]
                }
              ]
            }
          ],
          "output": [
            {
              "type": "Bundle"
            }
          ],
          "participant": [
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-participantCapabilityStatement",
                  "valueCanonical": "http://hl7.org/fhir/uv/cpg/CapabilityStatement/cpg-patient-registry"
                }
              ],
              "type": "device"
            }
          ]
        },
        {
          "title": "Resolve patient match results",
          "input": [
            {
              "type": "Bundle"
            }
          ],
          "output": [
            {
              "type": "Patient"
            }
          ],
          "participant": [
            {
              "type": "practitioner",
              "role": {
                "coding": [
                  {
                    "system": "http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-persona",
                    "code": "W000",
                    "display": "Clerical support worker"
                  }
                ]
              }
            }
          ]
        },
        {
          "title": "New patient",
          "condition": [
            {
              "kind": "applicability",
              "expression": {
                "language": "text/cql",
                "expression": "not exists %input i where i is Patient"
              }
            }
          ],
          "input": [
            {
              "type": "Patient"
            }
          ],
          "action": [
            {
              "title": "Gather patient information",
              "input": [
                {
                  "type": "QuestionnaireResponse",
                  "codeFilter": [
                    {
                      "path": "questionnaire",
                      "code": [
                        {
                          "code": "http://hl7.org/fhir/uv/cpg/Questionnaire/cpg-common-identity"
                        }
                      ]
                    }
                  ]
                }
              ],
              "output": [
                {
                  "type": "QuestionnaireResponse"
                }
              ]
            },
            {
              "title": "Record patient data",
              "input": [
                {
                  "type": "QuestionnaireResponse",
                  "codeFilter": [
                    {
                      "path": "questionnaire",
                      "code": [
                        {
                          "code": "http://hl7.org/fhir/uv/cpg/Questionnaire/cpg-common-patient-profile"
                        }
                      ]
                    }
                  ]
                }
              ],
              "output": [
                {
                  "type": "Patient"
                }
              ],
              "participant": [
                {
                  "extension": [
                    {
                      "url": "http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-participantCapabilityStatement",
                      "valueCanonical": "http://hl7.org/fhir/uv/cpg/CapabilityStatement/cpg-patient-registry"
                    }
                  ],
                  "type": "device"
                }
              ]
            }
          ]
        },
        {
          "title": "Existing patient",
          "condition": [
            {
              "kind": "applicability",
              "expression": {
                "language": "text/cql",
                "expression": "exists %input i where i is Patient"
              }
            }
          ],
          "input": [
            {
              "type": "Patient"
            }
          ],
          "action": [
            {
              "title": "Ensure patient information is up to date",
              "input": [
                {
                  "type": "QuestionnaireResponse",
                  "codeFilter": [
                    {
                      "path": "questionnaire",
                      "code": [
                        {
                          "code": "http://hl7.org/fhir/uv/cpg/Questionnaire/cpg-common-identity"
                        }
                      ]
                    }
                  ]
                }
              ],
              "output": [
                {
                  "type": "QuestionnaireResponse"
                }
              ]
            },
            {
              "title": "Record patient data",
              "input": [
                {
                  "type": "QuestionnaireResponse",
                  "codeFilter": [
                    {
                      "path": "questionnaire",
                      "code": [
                        {
                          "code": "http://hl7.org/fhir/uv/cpg/Questionnaire/cpg-common-patient-profile"
                        }
                      ]
                    }
                  ]
                }
              ],
              "output": [
                {
                  "type": "Patient"
                }
              ],
              "participant": [
                {
                  "extension": [
                    {
                      "url": "http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-participantCapabilityStatement",
                      "valueCanonical": "http://hl7.org/fhir/uv/cpg/CapabilityStatement/cpg-patient-registry"
                    }
                  ],
                  "type": "device"
                }
              ]
            }
          ]
        },
        {
          "title": "Patient summary lookup",
          "input": [
            {
              "type": "Patient"
            }
          ],
          "output": [
            {
              "type": "Bundle"
            }
          ],
          "participant": [
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-participantCapabilityStatement",
                  "valueCanonical": "http://hl7.org/fhir/uv/cpg/CapabilityStatement/cpg-patient-registry"
                }
              ],
              "type": "device"
            }
          ]
        }
      ]
    }
  ]
}